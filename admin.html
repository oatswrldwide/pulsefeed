<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PulseFeed - HR Admin Dashboard</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Core Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.0/echarts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    
    <!-- Custom Styles -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', system-ui, sans-serif;
        }
        
        .animate-fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        
        .animate-slide-in {
            animation: slideIn 0.5s ease-out forwards;
        }
        
        .animate-bounce {
            animation: bounce 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes bounce {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
        }
        
        .card {
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* Mobile optimizations */
        @media (max-width: 640px) {
            .mobile-stack {
                flex-direction: column;
                gap: 1rem;
            }
            
            .mobile-full-width {
                width: 100%;
            }
        }
        
        /* Chart container styling */
        .chart-container {
            min-height: 300px;
        }
        
        /* Status badge styling */
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .status-pending {
            background-color: #FEF3C7;
            color: #92400E;
        }
        
        .status-approved {
            background-color: #D1FAE5;
            color: #065F46;
        }
        
        .status-flagged {
            background-color: #FEE2E2;
            color: #991B1B;
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">
    <!-- Navigation Header -->
    <header class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo and Brand -->
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-900">PulseFeed</h1>
                        <span class="text-xs text-indigo-600 bg-indigo-50 px-2 py-1 rounded-full">HR Admin</span>
                    </div>
                </div>
                
                <!-- Navigation -->
                <nav class="hidden md:flex items-center space-x-6">
                    <a href="employee.html" class="text-gray-600 hover:text-indigo-600 transition-colors">Employee View</a>
                    <a href="admin.html" class="text-indigo-600 font-medium border-b-2 border-indigo-600 pb-1">HR Dashboard</a>
                    <button onclick="logout()" class="text-gray-600 hover:text-indigo-600 transition-colors">Logout</button>
                </nav>
                
                <!-- Mobile Menu Button -->
                <button class="md:hidden p-2 text-gray-600 hover:text-indigo-600" onclick="toggleMobileMenu()">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-200">
            <div class="px-4 py-2 space-y-1">
                <a href="employee.html" class="block px-3 py-2 text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded-md">Employee View</a>
                <a href="admin.html" class="block px-3 py-2 text-indigo-600 font-medium bg-indigo-50 rounded-md">HR Dashboard</a>
                <button onclick="logout()" class="block w-full text-left px-3 py-2 text-gray-600 hover:text-indigo-600 hover:bg-gray-50 rounded-md">Logout</button>
            </div>
        </div>
    </header>
    
    <!-- Main Dashboard -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Dashboard Header -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-2">HR Analytics Dashboard</h2>
            <p class="text-gray-600">Monitor employee feedback sentiment, trends, and moderate content in real-time.</p>
        </div>
        
        <!-- Key Metrics -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Total Posts</p>
                        <p class="text-3xl font-bold text-gray-900" id="total-posts">0</p>
                    </div>
                    <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                        </svg>
                    </div>
                </div>
                <div class="mt-4">
                    <span class="text-sm text-emerald-600 font-medium">+12% from last week</span>
                </div>
            </div>
            
            <div class="card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Sentiment Score</p>
                        <p class="text-3xl font-bold text-gray-900" id="sentiment-score">0%</p>
                    </div>
                    <div class="w-12 h-12 bg-emerald-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                </div>
                <div class="mt-4">
                    <span class="text-sm text-emerald-600 font-medium">+5% improvement</span>
                </div>
            </div>
            
            <div class="card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Pending Review</p>
                        <p class="text-3xl font-bold text-gray-900" id="pending-count">0</p>
                    </div>
                    <div class="w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                </div>
                <div class="mt-4">
                    <span class="text-sm text-amber-600 font-medium">Requires attention</span>
                </div>
            </div>
            
            <div class="card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Active Users</p>
                        <p class="text-3xl font-bold text-gray-900" id="active-users">0</p>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                        </svg>
                    </div>
                </div>
                <div class="mt-4">
                    <span class="text-sm text-blue-600 font-medium">Online now</span>
                </div>
            </div>
        </div>
        
        <!-- Charts and Analytics -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            
            <!-- Sentiment Trend Chart -->
            <div class="card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">Sentiment Trend (Last 7 Days)</h3>
                    <div class="flex items-center space-x-2">
                        <div class="w-3 h-3 bg-emerald-500 rounded-full"></div>
                        <span class="text-sm text-gray-600">Positive</span>
                        <div class="w-3 h-3 bg-amber-500 rounded-full ml-4"></div>
                        <span class="text-sm text-gray-600">Neutral</span>
                        <div class="w-3 h-3 bg-rose-500 rounded-full ml-4"></div>
                        <span class="text-sm text-gray-600">Negative</span>
                    </div>
                </div>
                <div id="sentiment-chart" class="chart-container"></div>
            </div>
            
            <!-- Top Topics -->
            <div class="card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-900">Trending Topics</h3>
                    <button onclick="refreshTopics()" class="text-sm text-indigo-600 hover:text-indigo-700">Refresh</button>
                </div>
                <div id="topics-cloud" class="min-h-[300px]">
                    <!-- Topics will be rendered here -->
                </div>
            </div>
        </div>
        
        <!-- Moderation Panel -->
        <div class="card bg-white rounded-lg shadow-sm border border-gray-200">
            <div class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg font-semibold text-gray-900">Content Moderation</h3>
                    <div class="flex items-center space-x-4">
                        <!-- Filter Dropdown -->
                        <select id="status-filter" class="px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="all">All Posts</option>
                            <option value="pending">Pending Review</option>
                            <option value="approved">Approved</option>
                            <option value="flagged">Flagged</option>
                        </select>
                        
                        <!-- Bulk Actions -->
                        <div class="flex items-center space-x-2">
                            <button onclick="bulkApprove()" class="px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors">
                                Approve Selected
                            </button>
                            <button onclick="bulkFlag()" class="px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors">
                                Flag Selected
                            </button>
                            <button onclick="bulkDelete()" class="px-4 py-2 bg-rose-600 text-white rounded-lg hover:bg-rose-700 transition-colors">
                                Delete Selected
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Moderation Table -->
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left">
                                <input type="checkbox" id="select-all" class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                            </th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Content</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sentiment</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tags</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Reactions</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="moderation-table-body" class="bg-white divide-y divide-gray-200">
                        <!-- Table rows will be rendered here -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Settings Panel -->
        <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <!-- Keyword Alerts -->
            <div class="card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Keyword Alerts</h3>
                <p class="text-sm text-gray-600 mb-4">Posts containing these keywords will be automatically flagged for review.</p>
                
                <textarea 
                    id="keyword-alerts" 
                    rows="4" 
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="Enter keywords separated by commas..."
                >harassment, safety, violence, discrimination, bullying, abuse</textarea>
                
                <div class="flex items-center justify-between mt-4">
                    <button onclick="saveKeywords()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">
                        Save Settings
                    </button>
                    <div class="flex items-center space-x-2">
                        <input type="checkbox" id="auto-moderation" class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                        <label for="auto-moderation" class="text-sm text-gray-700">Auto-moderation</label>
                    </div>
                </div>
            </div>
            
            <!-- Export Data -->
            <div class="card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Export Data</h3>
                <p class="text-sm text-gray-600 mb-4">Download feedback data for further analysis and reporting.</p>
                
                <div class="space-y-4">
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="text-sm font-medium text-gray-900">All Feedback Data</p>
                            <p class="text-xs text-gray-500">Complete dataset in CSV format</p>
                        </div>
                        <button onclick="exportData('all')" class="px-4 py-2 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 transition-colors">
                            Export CSV
                        </button>
                    </div>
                    
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="text-sm font-medium text-gray-900">Sentiment Analysis</p>
                            <p class="text-xs text-gray-500">Trends and analytics report</p>
                        </div>
                        <button onclick="exportData('analytics')" class="px-4 py-2 bg-emerald-600 text-white text-sm rounded-lg hover:bg-emerald-700 transition-colors">
                            Export Report
                        </button>
                    </div>
                    
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <div>
                            <p class="text-sm font-medium text-gray-900">Flagged Content</p>
                            <p class="text-xs text-gray-500">Posts requiring attention</p>
                        </div>
                        <button onclick="exportData('flagged')" class="px-4 py-2 bg-amber-600 text-white text-sm rounded-lg hover:bg-amber-700 transition-colors">
                            Export List
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="text-center">
                <div class="flex items-center justify-center space-x-2 mb-4">
                    <div class="w-6 h-6 bg-indigo-600 rounded-md flex items-center justify-center">
                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                    </div>
                    <span class="text-lg font-semibold text-gray-900">PulseFeed</span>
                </div>
                <p class="text-sm text-gray-600 mb-4">
                    HR Analytics Dashboard for monitoring employee feedback and workplace sentiment.
                </p>
                <div class="text-xs text-gray-500">
                    ¬© 2025 PulseFeed Demo. This is a demonstration application for showcasing HR feedback platform features.
                </div>
            </div>
        </div>
    </footer>
    
    <!-- JavaScript -->
    <script src="main.js"></script>
    
    <script>
        // Admin Dashboard specific functionality
        class AdminDashboard {
            constructor() {
                this.selectedPosts = new Set();
                this.init();
            }
            
            init() {
                this.updateMetrics();
                this.renderSentimentChart();
                this.renderTopicsCloud();
                this.renderModerationTable();
                this.setupEventListeners();
                this.loadSettings();
            }
            
            updateMetrics() {
                if (!window.app) return;
                
                const posts = window.app.posts;
                const totalPosts = posts.length;
                const pendingPosts = posts.filter(p => p.status === 'pending').length;
                const flaggedPosts = posts.filter(p => p.status === 'flagged').length;
                
                // Calculate sentiment score
                const positivePosts = posts.filter(p => p.sentiment === 'positive').length;
                const sentimentScore = Math.round((positivePosts / totalPosts) * 100);
                
                // Simulate active users
                const activeUsers = Math.floor(Math.random() * 50) + 20;
                
                // Update DOM
                document.getElementById('total-posts').textContent = totalPosts;
                document.getElementById('sentiment-score').textContent = sentimentScore + '%';
                document.getElementById('pending-count').textContent = pendingPosts;
                document.getElementById('active-users').textContent = activeUsers;
            }
            
            renderSentimentChart() {
                const chartDom = document.getElementById('sentiment-chart');
                const myChart = echarts.init(chartDom);
                
                // Generate sample data for the last 7 days
                const dates = [];
                const positiveData = [];
                const neutralData = [];
                const negativeData = [];
                
                for (let i = 6; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    dates.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
                    
                    // Generate realistic sentiment data
                    positiveData.push(Math.floor(Math.random() * 20) + 10);
                    neutralData.push(Math.floor(Math.random() * 10) + 5);
                    negativeData.push(Math.floor(Math.random() * 8) + 2);
                }
                
                const option = {
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'cross'
                        }
                    },
                    legend: {
                        data: ['Positive', 'Neutral', 'Negative'],
                        bottom: 0
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '15%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'category',
                        data: dates,
                        axisLine: {
                            lineStyle: {
                                color: '#e2e8f0'
                            }
                        },
                        axisLabel: {
                            color: '#64748b'
                        }
                    },
                    yAxis: {
                        type: 'value',
                        axisLine: {
                            lineStyle: {
                                color: '#e2e8f0'
                            }
                        },
                        axisLabel: {
                            color: '#64748b'
                        },
                        splitLine: {
                            lineStyle: {
                                color: '#f1f5f9'
                            }
                        }
                    },
                    series: [
                        {
                            name: 'Positive',
                            type: 'line',
                            data: positiveData,
                            smooth: true,
                            lineStyle: {
                                color: '#10b981'
                            },
                            itemStyle: {
                                color: '#10b981'
                            },
                            areaStyle: {
                                color: {
                                    type: 'linear',
                                    x: 0,
                                    y: 0,
                                    x2: 0,
                                    y2: 1,
                                    colorStops: [{
                                        offset: 0, color: 'rgba(16, 185, 129, 0.3)'
                                    }, {
                                        offset: 1, color: 'rgba(16, 185, 129, 0.05)'
                                    }]
                                }
                            }
                        },
                        {
                            name: 'Neutral',
                            type: 'line',
                            data: neutralData,
                            smooth: true,
                            lineStyle: {
                                color: '#f59e0b'
                            },
                            itemStyle: {
                                color: '#f59e0b'
                            }
                        },
                        {
                            name: 'Negative',
                            type: 'line',
                            data: negativeData,
                            smooth: true,
                            lineStyle: {
                                color: '#ef4444'
                            },
                            itemStyle: {
                                color: '#ef4444'
                            }
                        }
                    ]
                };
                
                myChart.setOption(option);
                
                // Make chart responsive
                window.addEventListener('resize', () => {
                    myChart.resize();
                });
            }
            
            renderTopicsCloud() {
                const container = document.getElementById('topics-cloud');
                
                // Extract and count tags from all posts
                const tagCounts = {};
                if (window.app) {
                    window.app.posts.forEach(post => {
                        post.tags.forEach(tag => {
                            tagCounts[tag] = (tagCounts[tag] || 0) + 1;
                        });
                    });
                }
                
                // Sort tags by frequency
                const sortedTags = Object.entries(tagCounts)
                    .sort(([,a], [,b]) => b - a)
                    .slice(0, 20);
                
                if (sortedTags.length === 0) {
                    container.innerHTML = '<div class="text-center text-gray-500 py-8">No topics found</div>';
                    return;
                }
                
                const maxCount = sortedTags[0][1];
                const minCount = sortedTags[sortedTags.length - 1][1];
                
                const topicsHTML = sortedTags.map(([tag, count]) => {
                    const size = Math.max(12, Math.min(24, 12 + (count - minCount) / (maxCount - minCount) * 12));
                    const opacity = 0.6 + (count - minCount) / (maxCount - minCount) * 0.4;
                    
                    return `
                        <span class="inline-block m-1 px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full cursor-pointer hover:bg-indigo-200 transition-colors"
                              style="font-size: ${size}px; opacity: ${opacity}"
                              onclick="filterByTag('${tag}')">
                            #${tag} (${count})
                        </span>
                    `;
                }).join('');
                
                container.innerHTML = `
                    <div class="flex flex-wrap justify-center items-center min-h-[250px]">
                        ${topicsHTML}
                    </div>
                `;
            }
            
            renderModerationTable() {
                const tbody = document.getElementById('moderation-table-body');
                if (!window.app) return;
                
                const posts = window.app.posts;
                const filter = document.getElementById('status-filter').value;
                
                const filteredPosts = filter === 'all' ? posts : posts.filter(p => p.status === filter);
                
                tbody.innerHTML = filteredPosts.map(post => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4">
                            <input type="checkbox" value="${post.id}" class="post-checkbox rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                        </td>
                        <td class="px-6 py-4 max-w-xs">
                            <div class="text-sm text-gray-900 truncate">${post.content}</div>
                            <div class="text-xs text-gray-500 mt-1">${window.app.formatTimestamp(post.created_at)}</div>
                        </td>
                        <td class="px-6 py-4">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                                post.sentiment === 'positive' ? 'bg-emerald-100 text-emerald-800' :
                                post.sentiment === 'negative' ? 'bg-rose-100 text-rose-800' :
                                'bg-amber-100 text-amber-800'
                            }">
                                ${post.sentiment}
                            </span>
                        </td>
                        <td class="px-6 py-4">
                            <div class="flex flex-wrap gap-1">
                                ${post.tags.map(tag => `
                                    <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800">
                                        #${tag}
                                    </span>
                                `).join('')}
                            </div>
                        </td>
                        <td class="px-6 py-4">
                            <div class="flex items-center space-x-2 text-sm text-gray-500">
                                <span>üëç ${post.reactions['üëç']}</span>
                                <span>üëé ${post.reactions['üëé']}</span>
                                <span>‚ù§Ô∏è ${post.reactions['‚ù§Ô∏è']}</span>
                            </div>
                        </td>
                        <td class="px-6 py-4">
                            <span class="status-badge status-${post.status}">${post.status}</span>
                        </td>
                        <td class="px-6 py-4">
                            <div class="flex items-center space-x-2">
                                ${post.status !== 'approved' ? `
                                    <button onclick="approvePost('${post.id}')" class="text-emerald-600 hover:text-emerald-700 text-sm font-medium">
                                        Approve
                                    </button>
                                ` : ''}
                                ${post.status !== 'flagged' ? `
                                    <button onclick="flagPost('${post.id}')" class="text-amber-600 hover:text-amber-700 text-sm font-medium">
                                        Flag
                                    </button>
                                ` : ''}
                                <button onclick="deletePost('${post.id}')" class="text-rose-600 hover:text-rose-700 text-sm font-medium">
                                    Delete
                                </button>
                            </div>
                        </td>
                    </tr>
                `).join('');
            }
            
            setupEventListeners() {
                // Select all checkbox
                document.getElementById('select-all').addEventListener('change', (e) => {
                    const checkboxes = document.querySelectorAll('.post-checkbox');
                    checkboxes.forEach(cb => {
                        cb.checked = e.target.checked;
                        if (e.target.checked) {
                            this.selectedPosts.add(cb.value);
                        } else {
                            this.selectedPosts.delete(cb.value);
                        }
                    });
                });
                
                // Individual checkboxes
                document.addEventListener('change', (e) => {
                    if (e.target.matches('.post-checkbox')) {
                        if (e.target.checked) {
                            this.selectedPosts.add(e.target.value);
                        } else {
                            this.selectedPosts.delete(e.target.value);
                        }
                    }
                });
                
                // Status filter
                document.getElementById('status-filter').addEventListener('change', () => {
                    this.renderModerationTable();
                });
            }
            
            loadSettings() {
                if (window.app) {
                    document.getElementById('keyword-alerts').value = window.app.settings.keyword_alerts.join(', ');
                    document.getElementById('auto-moderation').checked = window.app.settings.auto_moderation;
                }
            }
        }
        
        // Global functions for admin actions
        function approvePost(postId) {
            if (window.app) {
                const post = window.app.posts.find(p => p.id === postId);
                if (post) {
                    post.status = 'approved';
                    adminDashboard.renderModerationTable();
                    adminDashboard.updateMetrics();
                    window.app.showNotification('Post approved successfully!', 'success');
                }
            }
        }
        
        function flagPost(postId) {
            if (window.app) {
                const post = window.app.posts.find(p => p.id === postId);
                if (post) {
                    post.status = 'flagged';
                    adminDashboard.renderModerationTable();
                    adminDashboard.updateMetrics();
                    window.app.showNotification('Post flagged for review!', 'warning');
                }
            }
        }
        
        function deletePost(postId) {
            if (confirm('Are you sure you want to delete this post?')) {
                if (window.app) {
                    window.app.posts = window.app.posts.filter(p => p.id !== postId);
                    adminDashboard.renderModerationTable();
                    adminDashboard.updateMetrics();
                    window.app.showNotification('Post deleted successfully!', 'success');
                }
            }
        }
        
        function bulkApprove() {
            const selected = Array.from(adminDashboard.selectedPosts);
            if (selected.length === 0) {
                window.app.showNotification('Please select posts to approve.', 'error');
                return;
            }
            
            selected.forEach(postId => {
                const post = window.app.posts.find(p => p.id === postId);
                if (post) post.status = 'approved';
            });
            
            adminDashboard.selectedPosts.clear();
            adminDashboard.renderModerationTable();
            adminDashboard.updateMetrics();
            window.app.showNotification(`${selected.length} posts approved!`, 'success');
        }
        
        function bulkFlag() {
            const selected = Array.from(adminDashboard.selectedPosts);
            if (selected.length === 0) {
                window.app.showNotification('Please select posts to flag.', 'error');
                return;
            }
            
            selected.forEach(postId => {
                const post = window.app.posts.find(p => p.id === postId);
                if (post) post.status = 'flagged';
            });
            
            adminDashboard.selectedPosts.clear();
            adminDashboard.renderModerationTable();
            adminDashboard.updateMetrics();
            window.app.showNotification(`${selected.length} posts flagged!`, 'warning');
        }
        
        function bulkDelete() {
            const selected = Array.from(adminDashboard.selectedPosts);
            if (selected.length === 0) {
                window.app.showNotification('Please select posts to delete.', 'error');
                return;
            }
            
            if (confirm(`Are you sure you want to delete ${selected.length} posts?`)) {
                window.app.posts = window.app.posts.filter(p => !selected.includes(p.id));
                adminDashboard.selectedPosts.clear();
                adminDashboard.renderModerationTable();
                adminDashboard.updateMetrics();
                window.app.showNotification(`${selected.length} posts deleted!`, 'success');
            }
        }
        
        function refreshTopics() {
            adminDashboard.renderTopicsCloud();
            window.app.showNotification('Topics refreshed!', 'success');
        }
        
        function filterByTag(tag) {
            window.app.showNotification(`Filtering by tag: #${tag}`, 'info');
        }
        
        function saveKeywords() {
            const keywords = document.getElementById('keyword-alerts').value;
            const autoModeration = document.getElementById('auto-moderation').checked;
            
            if (window.app) {
                window.app.settings.keyword_alerts = keywords.split(',').map(k => k.trim()).filter(k => k);
                window.app.settings.auto_moderation = autoModeration;
            }
            
            window.app.showNotification('Settings saved successfully!', 'success');
        }
        
        function exportData(type) {
            if (window.app) {
                window.app.exportData();
            }
        }
        
        function logout() {
            window.location.href = 'employee.html';
        }
        
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }
        
        // Initialize admin dashboard when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.adminDashboard = new AdminDashboard();
        });
    </script>
</body>
</html>